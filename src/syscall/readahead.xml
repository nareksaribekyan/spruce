<TestSet Name="readahead">
	<Requires>fcntl.h</Requires>
	<Requires>unistd.h</Requires>
	<Test Name="ReadaheadNormal" FaultSimulationReady="true">
		<Description>perform file readahead into page cache</Description>
		<File count="1"/>
		<Header></Header>
		<Code>
			EnableFaultSim();
			if(readahead(FDs[0], 0, getpagesize()) == -1)
			{
				Error("readahead failed", Fail);
			}
		</Code>
		<Footer>
			Return(Success);
		</Footer>
	</Test>
	<Test Name="ReadaheadErrBadF">
		<Description>fd is not a valid file descriptor or is not open for reading</Description>
		<File count="1" flags="O_WRONLY | O_CREAT" mode="S_IRWXU"/>
		<Header>
			Status status = Success;
		</Header>
		<Code>
			if(readahead(FDs[0], 0, getpagesize()) != -1 || errno != EBADF)
			{
				Error("EBADF error expected: file was opened read only");
				status = Fail;
			}
			
			if(close(FDs[0]) == -1)
			{
				Error("close failed");
				FDs[0] = -1;	// make FDs[0] invalid file descriptor anyway (for the next test case) 
			}
			
			if(readahead(FDs[0], 0, getpagesize()) != -1 || errno != EBADF)
			{
				Error("EBADF error expected: invalid file descriptor");
				status = Fail;
			}
		</Code>
		<Footer>
			Return(status);
		</Footer>
	</Test>
</TestSet>
